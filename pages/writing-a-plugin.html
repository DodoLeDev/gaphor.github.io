<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Writing a Plugin - Gaphor</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://www.gaphor.org/pages/writing-a-plugin.html">

        <meta name="author" content="Arjan J. Molenaar and Dan Yeaw" />
        <meta name="description" content="Gaphor is designed to be extensible by using plugins that allow you to extend the functionality. Accessing Model Related Data The datamodel classes are located in the gaphor.UML module. Data objects can be accessed through the ElementFactory. This is a special class for creating and managing data objects. Items …" />

    <meta property="og:site_name" content="Gaphor" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Writing a Plugin"/>
    <meta property="og:url" content="https://www.gaphor.org/pages/writing-a-plugin.html"/>
    <meta property="og:description" content="Gaphor is designed to be extensible by using plugins that allow you to extend the functionality. Accessing Model Related Data The datamodel classes are located in the gaphor.UML module. Data objects can be accessed through the ElementFactory. This is a special class for creating and managing data objects. Items …" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.gaphor.org/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="https://www.gaphor.org/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.gaphor.org/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.gaphor.org/theme/css/style.css" type="text/css"/>

        <link href="https://www.gaphor.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Gaphor ATOM Feed"/>


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.gaphor.org/" class="navbar-brand">
<img class="img-responsive pull-left gap-right" src="https://www.gaphor.org/images/gaphor.svg" width="25"/> Gaphor            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/pages/download.html">Download</a></li>
                    <li><a href="/pages/about.html">About</a></li>
                    <li><a href="/pages/tutorials.html">Tutorials</a></li>
                    <li><a href="/pages/how-to.html">How-to</a></li>
                    <li><a href="/pages/discuss.html">Discuss</a></li>
                    <li><a href="/pages/developers.html">Developers</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content" class="body">
        <h1 class="entry-title">Writing a Plugin</h1>
        
        <div class="entry-content">
            <p>Gaphor is designed to be extensible by using plugins that allow you to extend
the functionality.</p>
<h2>Accessing Model Related Data</h2>
<p>The datamodel classes are located in the <code>gaphor.UML</code> module. Data objects can
be accessed through the ElementFactory. This is a special class for creating
and managing data objects. Items can be queried using this element factory,
which is registered in the application as <code>element_factory</code>. When writing a
service or plugin the element factory can be injected into the service like
this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyThing</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">element_factory</span> <span class="o">=</span> <span class="n">Application</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="s1">&#39;element_factory&#39;</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">element_factory</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
</pre></div>


<p>In the console window services can be retrieved by using the <code>service()</code>
function. For example:</p>
<div class="highlight"><pre><span></span><span class="err">ef = service(&#39;element_factory&#39;)</span>
</pre></div>


<h2>Querying the Data Model</h2>
<p>Two methods are used for querying:</p>
<ul>
<li><code>select(query=None)</code> -&gt; returns an iterator</li>
<li><code>lselect(query=None)</code> -&gt; returns a list</li>
</ul>
<p><code>query</code> is a lambda function with the element as parameter. For example, to
fetch all of the Class instances from the element factory:</p>
<div class="highlight"><pre><span></span><span class="err">element_factory.select(lambda e: e.isKindOf(UML.Class))</span>
</pre></div>


<h2>Traversing Data Instances</h2>
<p>Once some classes are obtained, it is common to traverse through a few related
objects in order to get the required information. For example: to iterate
through all parameters related to a class' operations:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">ownedOperation</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">ownedParameter</span><span class="p">:</span>
        <span class="n">do_something</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>


<p>Using the <code>[:]</code> operator items can be traversed more easily:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">ownedOperation</span><span class="p">[:]</span><span class="o">.</span><span class="n">ownedParameter</span><span class="p">:</span>
    <span class="n">do_something</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>


<p>It's also possible to provide a query as part of the selection:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">ownedOperation</span><span class="p">[</span><span class="s1">&#39;it.returnParameter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ownedParameter</span><span class="p">:</span>
    <span class="n">do_something</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>


<p>The variable <code>it</code> in the query refers to the evaluated object (in this
case all operations with a return parameter are taken into account).</p>
<h2>Example Plugin</h2>
<p>An example Hello World plugin is hosted on
<a href="https://github.com/gaphor/gaphor.plugins.helloworld">GitHub</a>.</p>
        </div>
    </section>
        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
</li>
<!-- End Sidebar/Github -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy;  Arjan J. Molenaar and Dan Yeaw
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>                <p><small>  <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">Creative Commons Attribution-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.gaphor.org/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.gaphor.org/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.gaphor.org/theme/js/respond.min.js"></script>



<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = 'https://www.gaphor.org/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'Gaphor',
    count: 3,
    skip_forks: false,
    target: '#gh_repos'
  });
});
</script>
<script src="https://www.gaphor.org/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->


</body>
</html>